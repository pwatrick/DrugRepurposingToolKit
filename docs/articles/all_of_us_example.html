<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clinical Validation Study Example in the NIH *All of Us* Research Program Database â€¢ DrugRepurposingToolKit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Clinical Validation Study Example in the NIH *All of Us* Research Program Database">
<meta property="og:description" content="DrugRepurposingToolKit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DrugRepurposingToolKit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/all_of_us_example.html">Clinical Validation Study Example in the NIH *All of Us* Research Program Database</a>
    </li>
    <li>
      <a href="../articles/gene_expression_signature_matching_example.html">Gene Expression Signature Matching to Identify Drug Repurposing Candidates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pwatrick/DrugRepurposingToolKit/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="all_of_us_example_files/header-attrs-2.11/header-attrs.js"></script><script src="all_of_us_example_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="all_of_us_example_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="all_of_us_example_files/datatables-binding-0.19/datatables.js"></script><script src="all_of_us_example_files/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="all_of_us_example_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="all_of_us_example_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="all_of_us_example_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="all_of_us_example_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="all_of_us_example_files/crosstalk-1.1.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Clinical Validation Study Example in the NIH <em>All of Us</em> Research Program Database</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pwatrick/DrugRepurposingToolKit/blob/master/vignettes/all_of_us_example.Rmd"><code>vignettes/all_of_us_example.Rmd</code></a></small>
      <div class="hidden name"><code>all_of_us_example.Rmd</code></div>

    </div>

    
    
<p><strong>Author</strong>: Patrick Wu<br><strong>Date</strong>: 2021-04-05</p>
<p><strong>Note:</strong> In this vignette, individual-level data are used for demonstration purposes only, and were not derived from real-world patients.</p>
<div id="set-up-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#set-up-packages" class="anchor"></a>Set up packages</h2>
<p>Install required packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"janitor"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"pwatrick/DrugRepurposingToolKit"</span><span class="op">)</span></code></pre></div>
<p>Import packages</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue">glue</a></span><span class="op">)</span>; 
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>; 
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>;
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://vroom.r-lib.org">vroom</a></span><span class="op">)</span>;
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>;
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pwatrick.github.io/DrugRepurposingToolKit">DrugRepurposingToolKit</a></span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
</div>
<div id="download-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-data" class="anchor"></a>Download data</h2>
<p>Define variables for functions</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">drug_concept_id</span> <span class="op">&lt;-</span> <span class="st">"1332418"</span>
<span class="va">biomarker_concept_id</span> <span class="op">&lt;-</span> <span class="st">"3004249"</span>
<span class="va">indication_drug_concept_ids</span> <span class="op">&lt;-</span>
        <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">[1139 chars quoted with '"']</span><span class="op">)</span></code></pre></div>
<p>Download covariates data</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create SQL query</span>
<span class="va">covariates_query</span> <span class="op">&lt;-</span>
  <span class="fu">DrugRepurposingToolKit</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_clinical_data.html">extract_clinical_data</a></span><span class="op">(</span><span class="va">drug_concept_id</span>, 
                                                <span class="va">biomarker_concept_id</span>, 
                                                table_name <span class="op">=</span> <span class="st">"hypertension_amlodipine_drugs"</span>, 
                                                table_type <span class="op">=</span> <span class="st">"covariates"</span>, 
                                                <span class="va">indication_drug_concept_ids</span><span class="op">)</span>
<span class="co">## Execute query</span>
<span class="va">hypertension_amlodipine_covariates</span> <span class="op">&lt;-</span> 
  <span class="fu">bigrquery</span><span class="fu">::</span><span class="fu">bq_table_download</span><span class="op">(</span>
    <span class="fu">bigrquery</span><span class="fu">::</span><span class="fu">bq_dataset_query</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"WORKSPACE_CDR"</span><span class="op">)</span>,
                                <span class="va">covariates_query</span>,
                                billing<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"GOOGLE_PROJECT"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Save `hypertension_amlodipine_covariates` to CSV file</span>
<span class="va">my_bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">'WORKSPACE_BUCKET'</span><span class="op">)</span>
<span class="va">covariates_file</span> <span class="op">&lt;-</span> <span class="st">"hypertension_amlodipine_covariates.csv"</span>
<span class="fu">write_csv</span><span class="op">(</span><span class="va">hypertension_amlodipine_covariates</span>, <span class="va">covariates_file</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gsutil cp ./"</span>, <span class="va">covariates_file</span>, <span class="st">" "</span>, <span class="va">my_bucket</span>, <span class="st">"/data/"</span><span class="op">)</span>, intern<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gsutil ls "</span>, <span class="va">my_bucket</span>, <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"/data/hypertension_amlodipine_covariates.csv"</span><span class="op">)</span><span class="op">)</span>, intern<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<p>Example <code>hypertension_amlodipine_covariates</code> table</p>
<div id="htmlwidget-f843a680a1fcd62a0dd1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f843a680a1fcd62a0dd1">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],[1,2,3],["1957-04-18","1985-05-01","1950-12-25"],[8532,8507,8507],[38003598,8527,8527],[1332418,1332418,1332418],["2010-03-02","2016-09-30\t","2011-01-24"],["2010-12-07","2016-11-10","2014-08-01"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>person_id<\/th>\n      <th>dob<\/th>\n      <th>gender_concept_id<\/th>\n      <th>race_concept_id<\/th>\n      <th>drug_concept_id<\/th>\n      <th>first_drug_exposure<\/th>\n      <th>last_drug_exposure<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Download drugs data</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create SQL query</span>
<span class="va">drugs_query</span> <span class="op">&lt;-</span>
  <span class="fu">DrugRepurposingToolKit</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_clinical_data.html">extract_clinical_data</a></span><span class="op">(</span><span class="va">drug_concept_id</span>, 
                                                <span class="va">biomarker_concept_id</span>, 
                                                table_name <span class="op">=</span> <span class="st">"hypertension_amlodipine_drugs"</span>, 
                                                table_type <span class="op">=</span> <span class="st">"drugs"</span>, 
                                                <span class="va">indication_drug_concept_ids</span><span class="op">)</span>
<span class="co">## Execute query</span>
<span class="va">hypertension_amlodipine_drugs</span> <span class="op">&lt;-</span> 
  <span class="fu">bigrquery</span><span class="fu">::</span><span class="fu">bq_table_download</span><span class="op">(</span>
    <span class="fu">bigrquery</span><span class="fu">::</span><span class="fu">bq_dataset_query</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"WORKSPACE_CDR"</span><span class="op">)</span>,
                                <span class="va">drugs_query</span>,
                                billing<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"GOOGLE_PROJECT"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Save `hypertension_amlodipine_covariates` to CSV file</span>
<span class="va">my_bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">'WORKSPACE_BUCKET'</span><span class="op">)</span>
<span class="va">drugs_file</span> <span class="op">&lt;-</span> <span class="st">"hypertension_amlodipine_drugs.csv"</span>
<span class="fu">write_csv</span><span class="op">(</span><span class="va">hypertension_amlodipine_drugs</span>, <span class="va">drugs_file</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gsutil cp ./"</span>, <span class="va">drugs_file</span>, <span class="st">" "</span>, <span class="va">my_bucket</span>, <span class="st">"/data/"</span><span class="op">)</span>, intern<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gsutil ls "</span>, <span class="va">my_bucket</span>, <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"/data/hypertension_amlodipine_drugs.csv"</span><span class="op">)</span><span class="op">)</span>, intern<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<p>Example <code>hypertension_amlodipine_drugs</code> table</p>
<div id="htmlwidget-ba32e0541469b5ed4906" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ba32e0541469b5ed4906">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],[1,2,3],["2009-03-02","2015-09-30","2010-01-24"],["2011-03-02","2017-09-30","2012-01-24"],["2010-03-02","2016-11-09","2011-01-24"],[1332421,19103475,957138]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>person_id<\/th>\n      <th>start_date<\/th>\n      <th>end_date<\/th>\n      <th>drug_exposure_start_date<\/th>\n      <th>drug_concept_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Download biomarkers data</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Create SQL query</span>
<span class="va">biomarkers_query</span> <span class="op">&lt;-</span>
  <span class="fu">DrugRepurposingToolKit</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_clinical_data.html">extract_clinical_data</a></span><span class="op">(</span><span class="va">drug_concept_id</span>, 
                                                <span class="va">biomarker_concept_id</span>, 
                                                table_name <span class="op">=</span> <span class="st">"hypertension_amlodipine_drugs"</span>, 
                                                table_type <span class="op">=</span> <span class="st">"biomarkers"</span>, 
                                                <span class="va">indication_drug_concept_ids</span><span class="op">)</span>
<span class="co">## Execute query</span>
<span class="va">hypertension_amlodipine_biomarkers</span> <span class="op">&lt;-</span> 
  <span class="fu">bigrquery</span><span class="fu">::</span><span class="fu">bq_table_download</span><span class="op">(</span>
    <span class="fu">bigrquery</span><span class="fu">::</span><span class="fu">bq_dataset_query</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"WORKSPACE_CDR"</span><span class="op">)</span>,
                                <span class="va">biomarkers_query</span>,
                                billing<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"GOOGLE_PROJECT"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Save `hypertension_amlodipine_covariates` to CSV file</span>
<span class="va">my_bucket</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">'WORKSPACE_BUCKET'</span><span class="op">)</span>
<span class="va">biomarkers_file</span> <span class="op">&lt;-</span> <span class="st">"hypertension_amlodipine_biomarkers.csv"</span>
<span class="fu">write_csv</span><span class="op">(</span><span class="va">hypertension_amlodipine_biomarkers</span>, <span class="va">biomarkers_file</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gsutil cp ./"</span>, <span class="va">biomarkers_file</span>, <span class="st">" "</span>, <span class="va">my_bucket</span>, <span class="st">"/data/"</span><span class="op">)</span>, intern<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gsutil ls "</span>, <span class="va">my_bucket</span>, <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"/data/hypertension_amlodipine_biomarkers.csv"</span><span class="op">)</span><span class="op">)</span>, intern<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<p>Example <code>hypertension_amlodipine_biomarkers</code> table</p>
<div id="htmlwidget-484ed42468d86de4a421" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-484ed42468d86de4a421">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],[1,2,3],["2009-03-02","2015-09-30","2010-01-24"],["2010-03-02","2017-06-07","2011-01-24"],["2011-03-02","2017-09-30","2012-01-24"],[3004249,3004249,3004249],[145,153,135]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>person_id<\/th>\n      <th>start_date<\/th>\n      <th>measurement_date<\/th>\n      <th>end_date<\/th>\n      <th>measurement_concept_id<\/th>\n      <th>value_as_number<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="process-data" class="section level2">
<h2 class="hasAnchor">
<a href="#process-data" class="anchor"></a>Process data</h2>
<p>Process data to create table to perform paired two-tailed t-test</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Import data from saved CSV files</span>
<span class="va">r_c</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span><span class="st">"hypertension_amlodipine_covariates.csv"</span>,
                    .name <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/janitor/man/make_clean_names.html">make_clean_names</a></span>, 
                    col_types <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">cols</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">r_d</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span><span class="st">"hypertension_amlodipine_drugs.csv"</span>,
                    .name <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/janitor/man/make_clean_names.html">make_clean_names</a></span>, 
                    col_types <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">cols</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">r_b</span> <span class="op">&lt;-</span> <span class="fu">vroom</span><span class="fu">::</span><span class="fu"><a href="https://vroom.r-lib.org/reference/vroom.html">vroom</a></span><span class="op">(</span><span class="st">"hypertension_amlodipine_biomarkers.csv"</span>,
                    .name <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/janitor/man/make_clean_names.html">make_clean_names</a></span>, 
                    col_types <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">cols</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>


<span class="co">#Prepare data for paired two-tailed t-test</span>
<span class="va">drug</span> <span class="op">&lt;-</span> <span class="st">"amlodipine"</span>
<span class="va">phenotype</span> <span class="op">&lt;-</span> <span class="st">"Hypertension"</span>
<span class="va">biomarker</span> <span class="op">&lt;-</span> <span class="st">"Systolic Blood Pressure"</span>
<span class="va">indication_drugs</span> <span class="op">&lt;-</span> <span class="fu">DrugRepurposingToolKit</span><span class="fu">::</span><span class="va"><a href="../reference/drugsHypertension.html">drugsHypertension</a></span>
<span class="va">concept_id_exclusions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2212451</span><span class="op">)</span>

<span class="va">htn_amlodipine_processed_data</span> <span class="op">&lt;-</span> 
  <span class="fu">DrugRepurposingToolKit</span><span class="fu">::</span><span class="fu"><a href="../reference/clean_process_clinical_data.html">clean_process_clinical_data</a></span><span class="op">(</span>
    <span class="va">drug</span>, <span class="va">phenotype</span>, <span class="va">biomarker</span>, <span class="va">indication_drugs</span>, <span class="va">concept_id_exclusions</span>, 
    <span class="va">r_c</span>, <span class="va">r_d</span>, <span class="va">r_b</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>drug <span class="op">=</span> <span class="st">"amlodipine"</span><span class="op">)</span></code></pre></div>
<p>Example <code>htn_amlodipine_processed_data</code> table</p>
<div id="htmlwidget-697d58abce2053a24549" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-697d58abce2053a24549">{"x":{"filter":"none","vertical":false,"data":[["1","2"],[1,2],[8532,8507],[38003598,8527],["2009-03-02","2015-09-30"],["2010-03-02","2016-09-30\t"],["2010-12-07","2016-11-10"],[51.87,30.41],[143,140],[138,140],[-5,0],["Systolic Blood Pressure","Systolic Blood Presure"],["amlodipine","amlodipine"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>person_id<\/th>\n      <th>gender_concept_id<\/th>\n      <th>race_concept_id<\/th>\n      <th>start_date<\/th>\n      <th>first_drug_exposure<\/th>\n      <th>final_end_date<\/th>\n      <th>age<\/th>\n      <th>biomarker_baseline_value<\/th>\n      <th>biomarker_treatment_value<\/th>\n      <th>biomarker_change<\/th>\n      <th>biomarker_name<\/th>\n      <th>drug<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,7,8,9,10]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="run-hypothesis-test" class="section level2">
<h2 class="hasAnchor">
<a href="#run-hypothesis-test" class="anchor"></a>Run hypothesis test</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Run paired two-tailed t-test</span>
<span class="va">htest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">htn_amlodipine_processed_data</span><span class="op">$</span><span class="va">biomarker_treatment_value</span>, 
                <span class="va">htn_amlodipine_processed_data</span><span class="op">$</span><span class="va">biomarker_baseline_value</span>, 
                conf.level <span class="op">=</span> <span class="fl">0.95</span>, 
                paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">tidy_htest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">htest</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">mutate</span><span class="op">(</span>drug <span class="op">=</span> <span class="va">drug</span>, 
           se <span class="op">=</span> <span class="va">htest</span><span class="op">$</span><span class="va">stderr</span>,
           biomarker <span class="op">=</span> <span class="st">"Systolic Blood Pressure"</span>, 
           phenotype <span class="op">=</span> <span class="st">"Hypertension"</span>, 
           source <span class="op">=</span> <span class="st">"All of Us"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">select</span><span class="op">(</span><span class="va">source</span>, <span class="va">drug</span>, <span class="va">phenotype</span>, <span class="va">biomarker</span>, <span class="va">estimate</span>, <span class="va">se</span>, <span class="va">statistic</span>, 
           <span class="va">p.value</span>, <span class="va">parameter</span>, <span class="va">conf.low</span>, <span class="va">conf.high</span>, <span class="va">method</span>, <span class="va">alternative</span><span class="op">)</span>

<span class="va">tidy_htest</span></code></pre></div>
<p>Example <code>tidy_htest</code> table</p>
<div id="htmlwidget-29a56e939b13f92b7856" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-29a56e939b13f92b7856">{"x":{"filter":"none","vertical":false,"data":[["1"],["All of Us"],["amlodipine"],["Hypertension"],["Systolic Blood Pressure"],[-5.24],[0.52],[-9.99],[3.92e-22],[733],[-6.27],[-4.21],["Paired t-test"],["two.sided"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>source<\/th>\n      <th>drug<\/th>\n      <th>phenotype<\/th>\n      <th>biomarker<\/th>\n      <th>estimate<\/th>\n      <th>se<\/th>\n      <th>statistic<\/th>\n      <th>p.value<\/th>\n      <th>parameter<\/th>\n      <th>conf.low<\/th>\n      <th>conf.high<\/th>\n      <th>method<\/th>\n      <th>alternative<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[5,6,7,8,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#metadata" class="anchor"></a>Metadata</h2>
<p>Workspace:</p>
<ul>
<li>Name: Drug Repurposing Validation Study<br>
</li>
<li>Owner: <a href="mailto:patrickwu@researchallofus.org" class="email">patrickwu@researchallofus.org</a>
</li>
</ul>
<p>Dataset:</p>
<ul>
<li>All of Us Dataset v4<br>
</li>
<li>Data access level: Registered</li>
</ul>
<p>Cloud compute profile:</p>
<ul>
<li>CPUs: 4<br>
</li>
<li>RAM (GB): 15<br>
</li>
<li>Disk (GB): 100<br>
</li>
<li>Compute type: Standard VM</li>
</ul>
<p>Time and cost to run notebook (without installing packages):</p>
<ul>
<li>Time: &lt; 1 hour<br>
</li>
<li>Cost: &lt; $0.20 USD</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Patrick Wu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
